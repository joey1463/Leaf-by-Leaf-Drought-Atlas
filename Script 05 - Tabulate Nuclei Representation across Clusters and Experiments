# This script will output description files for each of the different treatments within each different experiment

library(Seurat)
load("L1_plant_combined.RData")

# Leaf-by-Leaf Summary Table
plant_combined_rosette<-plant_combined[,plant_combined$experiment_type %in% c('rosette')]

plant_combined_rosette$all<-paste(substring(colnames(plant_combined_rosette),1,3),
                                  substring(colnames(plant_combined_rosette),7,9),
                                  substring(colnames(plant_combined_rosette),5,5),
                                  substring(colnames(plant_combined_rosette),11,13))

leaf_representation<-as.data.frame(table(plant_combined_rosette$all))
leaf_representation[,3]<-substr(leaf_representation[,1],5,7)
leaf_representation[,4]<-as.numeric(substr(leaf_representation[,1],2,3))
leaf_representation[,5]<-substr(leaf_representation[,1],9,9)
leaf_representation[,6]<-substr(leaf_representation[,1],11,13)
colnames(leaf_representation)<-c("sample","count","leaf_no","day","treatment","replicate")
write.table(leaf_representation,file="L1_table_leaf_by_leaf.txt",quote=F,sep="\t")

# Seedling Summary Table
plant_combined_seedling<-plant_combined[,plant_combined$experiment_type %in% c('seedling')]

plant_combined_seedling$all<-paste(substring(colnames(plant_combined_seedling),1,3), # time
                                  substring(colnames(plant_combined_seedling),7,9), # treatment
                                  substring(colnames(plant_combined_seedling),11,13)) # replicate

seedling_representation<-as.data.frame(table(plant_combined_seedling$all))
seedling_representation[,3]<-substr(seedling_representation[,1],1,3)
seedling_representation[,4]<-substr(seedling_representation[,1],5,7)
seedling_representation[,5]<-substr(seedling_representation[,1],8,11)
colnames(seedling_representation)<-c("sample","count","day","treatment","replicate")
write.table(seedling_representation,file="L1_table_seedling.txt",quote=F,sep="\t")

# Hormone Table
plant_combined_hormone<-plant_combined[,plant_combined$experiment_type %in% c('hormone')]

plant_combined_hormone$hormone<-plant_combined_hormone$Day
hormone_representation<-as.data.frame(table(plant_combined_hormone$hormone))
colnames(hormone_representation)<-c("horomone","count")
write.table(hormone_representation,file="L1_table_hormone.txt",quote=F,sep="\t")
